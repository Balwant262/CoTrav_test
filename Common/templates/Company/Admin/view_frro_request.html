{% extends 'Company/Admin/layout/header.html' %}
{% load static %}
{% block content %}
{% load datetime_format %}

{% if user %}
<!-- start page content -->
{% for visa in visas %}

<!--{{bookings}}-->
<div class="page-content-wrapper">
    <div class="page-content">

                 <div class="text-center">
                 <div style="font-size:14px; font-weight:bold;">
                     Frro Request Details
                     </div>
            </div>


        <input type="hidden" name="tab_status" id="tab_status" value="{{visa.tab_status}}">
        {% if visa.tab_status == 'cancelled'%}

            <div class="row">
                 <div class="col-md-2 col-md-offset-5 booking-detail-row" style="background-color: red; color: #ffffff; margin-top: 5px; margin-bottom: 5px; text-align: center;"><i class="fa fa-times" style="font-size: 16px; top: 4px; " aria-hidden="true"></i> <h4 style="border-bottom: none; color: #fff; font-size: 12px;">Cancelled Request</h4></div>
			</div>
          {% else %}
            <br/>
            <div style="top:4px;" class="progress-bar-wrapper"></div>
            <br/>
          {% endif %}




        <div class="row">

            <div class="col-md-3">

				 <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>Request Details</header>
                    </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">
								  <tr>
							<th>Booking ID</th>
							<td>{{ visa.reference_no }}</td>
						</tr>
                                                <tr>
                        <th>FRO Application ID</th>
                        <td>{{ visa.frro_application_id|default:'NA' }}</td>
                    </tr>
						<tr>
	                        <th>Booking Date</th>
	                        <td>{{ visa.booking_datetime|datetime_format }}</td>
	                    </tr>
	                    <tr>
	                        <th>Resident City</th>
	                        <td>{{ visa.hotel_city_name }}</td>
	                    </tr>
                    	<tr>
	                        <th>Request Type</th>
	                        <td>{{ visa.frro_request_type_name }}</td>
	                    </tr>
	                    <tr>
	                        <th>Company Status</th>
	                        <td>{{ visa.client_status }}</td>
	                    </tr>

	                    <tr>
	                        <th>CoTrav Status</th>
	                        <td>{{ visa.cotrav_status }}</td>
	                    </tr>

	                    <tr>
	                        <th>FRRO Status</th>
	                        <td>{{ visa.request_status }}</td>
	                    </tr>

	                    <tr>
	                        <th>Accepted By</th>
	                        <td>{{ visa.last_action_by }}</td>
	                    </tr>



	                    <tr>
	                        <th>Assessment Code / Project Code</th>
	                        <td>{{ visa.assessment_code }}</td>
	                    </tr>
	                    <tr>
	                        <th>Reason for Booking</th>
	                        <td>{{ visa.reason_of_booking }}</td>
	                    </tr>
                            <tr>
	                        <th>Registered Email</th>
	                        <td>{{ visa.registered_email }}</td>
	                    </tr>
                            <tr>
	                        <th>Registered Username</th>
	                        <td>{{ visa.registered_username }}</td>
	                    </tr>
                            <tr>
	                        <th>Registered Password</th>
	                        <td>{{ visa.registered_password }}</td>
	                    </tr>

                            <tr>
                        <th>Certificate</th>
                        <td>{% if visa.frro_certificate %}<a href="{{visa.frro_certificate}}">Download</a>{% else %}<label style="color:red;">NA</label>{% endif %}</td>
                    </tr>




							 </table>
                    </div>
                </div>
            </div>

                <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>Log History </header>
                    </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">



	                            {% for log in visa.ActionLogs %}
                                <tr>
                                      <td>
	                                <b>{{log.employee_name}}</b>&nbsp;[{{log.action_date}}]
                                        &nbsp;{{log.action}}
                                        <br/>
                                          </td>
                                    </tr>
	                            {% endfor %}




							 </table>
                        </div>

                    </div>
                    </div>

			</div>

            <div class="col-md-3">
            <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>SPOC Details</header>
                    </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">
								 <tr>
                                    <td>SPOC Name</td>
                                    <td>{{ visa.user_name }}</td>
                                </tr>

								 <tr>
                                    <td>Contact</td>
                                    <td>{{ visa.user_contact }}</td>
                                </tr>
								 <tr>
                                    <td>Email Id</td>
                                    <td>{{ visa.spoc_email }}</td>
                                </tr>

							 </table>
                        </div>

                    </div>
                    </div>



                <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>Request Letter Details</header>
                    </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">

                                <tr>
                                                <th style="width: 10%;">Sr. No.</th>
                                                <th style="width: 20%;">Letter Name</th>
                                                <th style="width: 20%;">Draft Letter</th>
                                                <th style="width: 40%;">Signed Letter</th>
                                                <th style="width: 10%;">Action</th>
                                            </tr>



	                            {% for log in visa.RequestLetters %}
                                 <tr>
                                    <td style="width: 10%;">{{ forloop.counter }}</td>
                                    <td style="width: 30%;">{% if log.document_name %}{{log.document_name}}{% else %}NA{% endif %}</td>
                                    <td style="width: 20%;">{% if log.document_path %}<a href="{{log.document_path}}">Download</a>{% else %}<label style="color:red;">Not Upload</label>{% endif %}</td>
                                    <td style="width: 20%;">{% if log.upload_document %}<a href="{{log.upload_document}}">Download</a>{% else %}<label style="color:red;">Not Upload</label>{% endif %}</td>
                                    <td style="width: 20%;"></td>
                                     </tr>
	                            {% endfor %}




							 </table>
                        </div>

                    </div>
                    </div>


                <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>FRRO Office Updates

                        </header>
                        </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">

                                <tr>
                                               <th style="width: 10%;">Sr. No.</th>
                                                <th style="width: 10%;">Type</th>
                                                <th style="width: 10%;">Status</th>
                                                <th style="width: 20%;">Spoc Comment</th>
                                                <th style="width: 20%;">CoTrav Comment</th>
                                                <th style="width: 10%;">Client Doc</th>
                                                <th style="width: 10%;">CoTrav Doc</th>
                                </tr>



	                            {% for log in visa.OfficeStatus %}
                                <tr>
                                    <td style="width: 10%;">{{ forloop.counter }}</td>
                                    <td style="width: 10%;">{{log.office_status_type}}</td>
                                    <td style="width: 10%;">{{log.office_status}}</td>
                                    <td style="width: 20%;">{{log.spoc_comment}}</td>
                                    <td style="width: 20%;">{{log.taxivaxi_comment}}</td>
                                    <td style="width: 10%;">{% if log.spoc_doc %}<a href="{{log.spoc_doc}}">Download</a>{% else %}<label style="color:red;">Not Upload</label>{% endif %}</td>
                                    <td style="width: 10%;">{% if log.taxivaxi_doc %}<a href="{{log.taxivaxi_doc}}">Download</a>{% else %}<label style="color:red;">Not Upload</label>{% endif %}</td>
                                </tr>
	                            {% endfor %}




							 </table>
                        </div>

                    </div>
                    </div>






            </div>


            <div class="col-md-6">

                                <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>Employee Details</header>
                    </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">

                                <tr>
                                    <th>Employee ID</th>
									<th>  Name  </th>
									<th>  Email Id </th>
									<th>  Contact  </th>
									<th>  Age   </th>
									<th>  Gender </th>

							</tr>

							{% for passanger in visa.Passangers %}
								<tr>
                                    <td><a target="_blank" href="/Corporate/Admin/view-employee-frro-details/{{ passanger.id|default:'' }}">{{ passanger.core_employee_id|default:'NA' }}</a></td>
                                <td>{{ passanger.employee_name|default:'' }}</td>
								<td>{{ passanger.employee_email|default:''}}</td>
							    <td>{{ passanger.employee_contact|default:''}}</td>
								<td>{{ passanger.age|default:''}}</td>
							    <td>{{ passanger.gender|default:''}}</td>

								</tr>
							{% endfor %}


							 </table>
                        </div>

                    </div>
                    </div>


                  <div class="card">
                    <div class="card-head card-topline-aqua">
                        <header>Employee Document Details</header>
                    </div>
                    <div class="card-body no-padding height-9">

                        <div class="form-group row">
							<table class="table table-striped table-bordered bootstrap-datatable datatable responsive">

                                {% for employee in visa.EmployeesDocs %}

								<tr>
                                    <td>{{employee.doc_name}}</td>
                                    <td>{% if employee.doc_file %}<a target="_blank" href="{{employee.doc_file}}" >Download</a>{% else %}<label style="color:red;">Document Not Upload</label>{% endif %}</td>
                                    <td>
                                        </td>

                                </tr>


                                {% endfor %}


							 </table>
                        </div>

                    </div>
                    </div>



            </div>





    </div>
    </div>
 {% endfor %}


</div>
<!-- end page content -->


{% else %}
<p>Welcome, new user. Please log in.<a href="/login">Login</a></p>
{% endif %}
<script type="text/javascript">
$(function() {

  $('#model_action_tracking').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget); // Button that triggered the modal
    var id = button.data('id'); // Extract info from data-* attributes
    var modal = $(this);
    modal.find('#booking_id_tracking').val(id);

    });
       });
       </script>


{% if visa.tab_status == 'cancelled'%}
{% else %}
<script src="{% static 'assets/js/progress-bar.js' %}"></script>
{% endif %}
<script >
//we can set animation delay as following in ms (default 1000)
ProgressBar.singleStepAnimation = 1500;
val = $('#tab_status').val();
val = val.charAt(0).toUpperCase() + val.substr(1);

ProgressBar.init(
  [
        'Unapproved',
        'Approved',
        'Acknowledged',
        'Application Submitted',
        'Under-process',
        'Completed',

  ],
  val,
  'progress-bar-wrapper' // created this optional parameter for container name (otherwise default container created)
);
</script>
{% endblock %}



